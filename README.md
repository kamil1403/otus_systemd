# otus_systemd
<p align="center">
  <img src="https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/lvm.jpg" alt="RAID Banner" width="800">
</p>

<h1 align="center">otus_systemd</h1>
<p align="center">–î–∞—Ç–∞: 30-09-2025<br>–ê–≤—Ç–æ—Ä: Kamil Ibragimov</p>

## –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ: —Ä–∞–±–æ—Ç–∞ —Å LVM
–ó–∞–¥–∞–Ω–∏–µ:   
‚Ä¢ –ù–∞–ø–∏—Å–∞—Ç—å service, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–∞–ª–∏—á–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ (—Ñ–∞–π–ª –ª–æ–≥–∞ –∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–æ–ª–∂–Ω—ã –∑–∞–¥–∞–≤–∞—Ç—å—Å—è –≤ /etc/default);
‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å spawn-fcgi –∏ —Å–æ–∑–¥–∞—Ç—å unit-—Ñ–∞–π–ª (spawn-fcgi.sevice) —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–¥–µ–ª–∫–∏ init-—Å–∫—Ä–∏–ø—Ç–∞ (https://gist.github.com/cea2k/1318020);
‚Ä¢ –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å unit-—Ñ–∞–π–ª Nginx (nginx.service) –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. 

–†–µ–∑—É–ª—å—Ç–∞—Ç:   
‚Ä¢ –°–æ–∑–¥–∞–ª Physical Volume, Volume Group –∏ Logical Volume. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["lvm_create"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/lvm_create.png)     
‚Ä¢ –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–ª —Ç–æ–º –∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤ –∫–∞—Ç–∞–ª–æ–≥ /lvm. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["mkfs.ext4"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/mkfs.ext4.png)     
‚Ä¢ –†–∞—Å—à–∏—Ä–∏–ª —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∑–∞ —Å—á–µ—Ç –Ω–æ–≤–æ–≥–æ –¥–∏—Å–∫–∞ –Ω–∞ 5Gb. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["resize"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/resize.png)   
‚Ä¢ –£–º–µ–Ω—å—à–∏–ª —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–æ 4Gb. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["resize_4Gb"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/resize_4G.png)   
‚Ä¢ –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª —Ñ–∞–π–ª—ã –≤ /lvm, —Å–æ–∑–¥–∞–ª —Å–Ω–µ–ø—à–æ—Ç, —É–¥–∞–ª–∏–ª —Ñ–∞–π–ª—ã –∏–∑ /lvm, –∞ –∑–∞—Ç–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª –∏—Ö –∏–∑ —Å–Ω–µ–ø—à–æ—Ç–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["snapshot"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/snapshot.png)  
‚Ä¢ –°–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª —Ç–æ–º "test" –≤ –∫–∞—Ç–∞–ª–æ–≥ /lvm. –í–∏–¥–Ω–æ, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–º —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–º. –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ üñºÔ∏è ["fstab"](https://github.com/kamil1403/otus_LVM-1/blob/main/screenshots/fstab.png)  


## üß≠ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [üõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ Physical Volume, Volume Group –∏ Logical Volume](#pvl)
- [‚öôÔ∏è –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã](#ext4)
- [‚úÇÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã](#resize_max)
- [‚úÇÔ∏è –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã](#resize_min)
- [üì∏ –†–∞–±–æ—Ç–∞ —Å–æ —Å–Ω–µ–ø—à–æ—Ç–∞–º–∏](#snapshot)
- [üìã –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ fstab](#fstab)

---

<a id="pvl"></a>
## üõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ Physical Volume, Volume Group –∏ Logical Volume

```bash
# LVM (Logical Volume Manager) ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏—Å–∫–∞–º–∏ –≤ Linux, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≥–∏–±–∫–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–æ—Å–∏—Ç–µ–ª—è—Ö   
# LVM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ —É—Ä–æ–≤–Ω—è:
# 1. PV (Physical Volume) ‚Äî —ç—Ç–æ "—Å—ã—Ä–æ–π" –¥–∏—Å–∫ –∏–ª–∏ —Ä–∞–∑–¥–µ–ª, –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ LVM   
pvcreate /dev/sdb
# 2. VG (Volume Group) ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ PV   
vgcreate otus /dev/sdb
# 3. LV ‚Äî —ç—Ç–æ "–∫—É—Å–æ–∫" –∏–∑ –≥—Ä—É–ø–ø—ã VG, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª, —Ç–æ–ª—å–∫–æ –≥–∏–±—á–µ   
lvcreate -L 10G -n test otus
# –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞ –Ω–∞ 80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞   
lvcreate -l+80%FREE -n test otus   
# –£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞   
lvremove /dev/otus/test   
# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LVM   
# –ü–æ–¥—Ä–æ–±–Ω–æ:  
pvdispaly 
vgdisplay   
lvdisplay   
# –ö—Ä–∞—Ç–∫–æ:   
pvs   
vgs   
lvs   
```

---

<a id="ext4"></a>
## ‚öôÔ∏è –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

```bash
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
mkfs.ext4 /dev/otus/test
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
mkdir /lvm
mount /dev/otus/test /lvm
```

---

<a id="resize_max"></a>
## ‚úÇÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ PV   
pvcreate /dev/sdc   
vgextend otus /dev/sdc   
# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞   
lvextend -l+80%FREE /dev/otus/test
# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
resize2fs /dev/otus/test
```

---

<a id="resize_min"></a>
## ‚úÇÔ∏è –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞   
umount /lvm   
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã   
e2fsck -f /dev/otus/test   
# –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã   
resize2fs /dev/otus/test 4G   
# –£–º–µ–Ω—å—à–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞   
lvreduce -L 4G /dev/otus/test   
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
mount /dev/otus/test /lvm
```

---

<a id="snapshot"></a>
## üì∏ –†–∞–±–æ—Ç–∞ —Å–æ —Å–Ω–µ–ø—à–æ—Ç–∞–º–∏

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–æ–º (–¥–ª—è —Ç–µ—Å—Ç–∞)
cp -r /var/log/* /lvm
# –°–æ–∑–¥–∞–Ω–∏–µ snapshot   
lvcreate -s -L 1G -n otus_snap /dev/otus/test 
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è snapshot
mkdir /snapshot 
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ snapshot –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞  
mount /dev/otus/otus_snap /snapshot  
# –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
rm -rf /lvm/* 
# –†–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
umount /lvm
umount /snapshot
# –î–µ–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞
lvchange -an /dev/otus/test
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ snapshot
lvconvert --merge /dev/otus/otus_snap
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞
lvchange -ay /dev/otus/test
# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–º–∞
mount /dev/otus/test /lvm
```

---

<a id="fstab"></a>
## üìã –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ fstab

```bash
# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç UUID –∏ —Ç–∏–ø —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ (–Ω—É–∂–µ–Ω –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ /etc/fstab)
blkid
# UUID otus-test
/dev/mapper/otus-test: UUID="3aaf9c58-0608-4fb9-8394-498d3edbc090" BLOCK_SIZE="4096" TYPE="ext4"
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª fstab –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
nano /etc/fstab
# –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–º–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥ /lvm
UUID=3aaf9c58-0608-4fb9-8394-498d3edbc090  /lvm ext4 defaults 0 2
```

---
